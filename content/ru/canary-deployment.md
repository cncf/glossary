---
title: Канареечное развертывание
status: Completed
category: concept
tags: ["methodology", "application", ""]
---

## Описание

Стратегия канареечных развертываний начинается с двух окружений: 
одно из них обслуживает живой трафик, другое содержит обновленный код (но без трафика).
Трафик постепенно переключается с исходной, старой версии приложения на новую.
Начинают обычно с минимального процента (например, с 1%) и постепенно увеличивают долю трафика, 
которая поступает в новую версию, пока та не достигнет 100%.
Стратегия позволяет протестировать новую версию ПО в production, получить обратную связь, 
диагностировать ошибки и при необходимости быстро откатиться к старой стабильной версии.

Сам термин происходит от старой практики, когда канарейки помогали выявить присутствие опасных газов в шахтах.
При наличии не имеющих запаха вредных газов птица погибала, и шахтеры понимали, что необходимо срочно эвакуироваться.
То же самое справедливо и для канареечных развертываний: если окажется, что с новым кодом что-то не так, 
можно сразу откатиться на старую версию.

## Проблема

Какой бы тщательной ни была стратегия тестирования, в процессе эксплуатации всегда обнаруживаются те или иные ошибки.
Переключение сразу всего трафика с одной версии приложения на другую может привести к масштабным сбоям.

## Решение

Канареечные развертывания позволяют посмотреть, как новое программное обеспечение поведет себя в реальных условиях, 
прежде чем направлять на него весь трафик.
Стратегия помогает минимизировать время простоя и быстро откатиться назад в случае возникновения проблем с новым развертыванием.
Также она позволяет проводить более глубокое тестирование production-приложений, не оказывая существенного влияния на общий пользовательский опыт.
